# **AnswerCell Documentation**

## **Overview**
This Excel Add-In integrates OpenAI's API with Microsoft Excel, allowing users to input questions in a specified column and automatically retrieve AI-generated answers. This tool uses the powerful capabilities of OpenAI to generate responses dynamically, making it easy to solve various business problems and analyze large datasets in Excel.

---

## **Key Features**
- **Dynamic Responses**: Input a question in a specified column, and get AI-generated responses in the adjacent output column.
- **Customizable Columns**: You can change the column names (e.g., from `A` to `C` or any other column) to suit your needs.
- **First-Time Setup**: The tool prompts for an OpenAI API key when it's run for the first time, making it easy to configure.

---

## **Pre-requisites**
Before using the Excel Add-In, you need to ensure that the following are set up on your computer:

1. **Python**: Python 3.9 or later should be installed on your system. You can download Python from [python.org](https://www.python.org/downloads/).
   
2. **Excel**: You need a working version of Microsoft Excel.

3. **OpenAI API Key**: You will need an OpenAI API key, which you can get from [OpenAI](https://platform.openai.com/account/api-keys).

4. **xlwings Add-In**: The `xlwings` add-in should be installed in Excel to connect Excel with Python.

---

## **Installation Instructions**

### **Step 1: Install Python and Dependencies**

1. **Install Python**:
   - Go to [python.org/downloads](https://www.python.org/downloads/) and download the latest version of Python.
   - During installation, ensure to check the option to **Add Python to PATH**.

2. **Install Required Packages**:
   - Open the command prompt (Windows) or terminal (Mac/Linux).
   - Run the following commands to install the required Python packages:
     ```bash
     pip install xlwings openai
     ```

### **Step 2: Install the xlwings Add-In for Excel**

1. **Install the xlwings Add-In**:
   - Open a command prompt or terminal and run the following command to install the `xlwings` add-in:
     ```bash
     xlwings addin install
     ```

2. **Verify the Add-In Installation**:
   - Open Excel.
   - Go to the **"Add-ins"** tab. You should see `xlwings` there.

### **Step 3: Setup the Project Files**

1. **Configure the Python Environment**:
   - Make sure that the `xlwings.conf` file is properly configured:
     - The `PYTHONPATH` should point to the project folder.
     - The `INTERPRETER` should point to your Python executable (usually `python.exe` on Windows or `/usr/bin/python3` on Mac/Linux).
   
   Example of `xlwings.conf`:
   ```plaintext
   [xlwings]
   PYTHONPATH = path/to/your/project
   INTERPRETER = path/to/python.exe
   ```

---

## **How to Use the Add-In**

### **Step 1: First-Time Setup**

1. **Run the Python Script**:
   - To set up the OpenAI API key, run the `main.py` script in the project folder.
   - Open the command prompt or terminal and run:
     ```bash
     python main.py
     ```
   - The script will prompt you to enter your OpenAI API key. Input the API key you got from [OpenAI](https://platform.openai.com/account/api-keys).
   - The API key will be saved for future use.

### **Step 2: Using the Add-In in Excel**

1. **Open Excel**:
   - Open a new or existing Excel workbook.

2. **Prepare Your Questions**:
   - In the worksheet, enter your questions in a column (e.g., column **A**). For example:
     ```
     A1: What is the color of the sky?
     A2: What is the capital of France?
     A3: What is the largest animal?
     ```

3. **Add a Button to Trigger Python Function**:
   - In Excel, go to the **"Developer"** tab. If the Developer tab is not visible, enable it by going to **File > Options > Customize Ribbon**.
   - Click **Insert** under the Developer tab and choose **Button**.
   - Draw a button on the sheet and assign the **ProcessData** macro to it.

4. **Assign Macro to Button**:
   - The macro will look like this in the VBA editor:
     ```vba
     Sub ProcessData()
         RunPython "import processor; processor.process_excel_data('A', 'B')"
     End Sub
     ```
   - This will process questions from column `A` and return answers in column `B`.

5. **Click the Button to Process Data**:
   - After setting up the button, click it to run the Python function.
   - The answers generated by OpenAI will appear in the output column (e.g., **column B**).

### **Step 3: Adjusting Columns**

- You can change the input and output columns by simply modifying the macro code in VBA or providing the new column letters when prompted.

---

## **Troubleshooting**

### **API Key Not Set**
- If you try to use the add-in and get an error like "API key not found," it means the API key has not been set up.
  - To fix this, run the `main.py` script again and input the OpenAI API key when prompted.

### **No Responses in Output**
- If no answers appear in the output column:
  - Ensure that the input column has questions.
  - Check that the OpenAI API key is correct.
  - Verify that the Python environment is correctly configured.

### **Error While Running Python**
- If you encounter errors related to Python, ensure the Python executable and project folder are correctly specified in the `xlwings.conf` file.

---

## **Maintenance**

1. **Updating the OpenAI API Key**:
   - If you need to update the OpenAI API key, simply run the `main.py` script again and input the new API key.
   
2. **Adding More Columns**:
   - If you want to process more columns, update the `process_excel_data` function in the `processor.py` file to handle additional columns.
   
3. **Scaling for Larger Datasets**:
   - The solution is designed for smaller datasets. For large-scale processing, you may need to modify the script to handle batch processing or optimize the API calls.

---

## **For Non-Programmers: How to Use**
- The Excel add-in has been designed to be user-friendly.
- **For first-time use**, just run the `main.py` script to set up the OpenAI API key.
- Once set up, non-programmers can simply input questions in Excel, click a button, and see the AI-generated responses without needing to interact with the Python code.